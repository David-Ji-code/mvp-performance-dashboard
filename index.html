<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Service Dashboard</title>
    <!-- Required Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-gradient"></script>
    <script src="https://cdn.jsdelivr.net/npm/moment@2.29.4/moment.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(59, 130, 246, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(59, 130, 246, 0); }
            100% { box-shadow: 0 0 0 0 rgba(59, 130, 246, 0); }
        }
        
        .pulse-animation {
            animation: pulse 1.5s ease-in-out;
        }

        #notificationContainer {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
        }
        
        .chart-container {
            position: relative;
            height: 300px;
            width: 100%;
        }
        
        .data-card {
            transition: all 0.3s ease;
        }
        
        .data-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>
<body class="bg-gray-50">
    <div id="notificationContainer"></div>
    
    <div class="container mx-auto p-4">
        <h1 class="text-2xl font-bold mb-6">Service Dashboard</h1>
        
        <!-- Dashboard Overview Section -->
        <div class="mb-6 grid grid-cols-1 md:grid-cols-4 gap-4">
            <div class="bg-white p-4 rounded-lg border border-gray-200 shadow-sm data-card">
                <div class="flex justify-between items-center">
                    <h3 class="text-gray-500 text-sm">Total Faults</h3>
                    <span class="text-blue-500">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                        </svg>
                    </span>
                </div>
                <div class="mt-2">
                    <h2 class="text-3xl font-bold" id="totalFaults">0</h2>
                    <p class="text-red-600 text-sm flex items-center mt-1">
                        <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"></path>
                        </svg>
                        <span id="faultGrowth">0%</span> this month
                    </p>
                </div>
            </div>
            
            <div class="bg-white p-4 rounded-lg border border-gray-200 shadow-sm data-card">
                <div class="flex justify-between items-center">
                    <h3 class="text-gray-500 text-sm">Power Outages</h3>
                    <span class="text-yellow-500">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                        </svg>
                    </span>
                </div>
                <div class="mt-2">
                    <h2 class="text-3xl font-bold" id="powerOutages">0</h2>
                    <p class="text-sm text-gray-500 mt-1">
                        <span id="outagePercentage" class="font-medium">0%</span> of total faults
                    </p>
                </div>
            </div>
            
            <div class="bg-white p-4 rounded-lg border border-gray-200 shadow-sm data-card">
                <div class="flex justify-between items-center">
                    <h3 class="text-gray-500 text-sm">Resolution Rate</h3>
                    <span class="text-green-500">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                    </span>
                </div>
                <div class="mt-2">
                    <h2 class="text-3xl font-bold" id="resolutionRate">0%</h2>
                    <p class="text-green-600 text-sm flex items-center mt-1">
                        <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"></path>
                        </svg>
                        <span id="resolutionGrowth">0%</span> vs last month
                    </p>
                </div>
            </div>
            
            <div class="bg-white p-4 rounded-lg border border-gray-200 shadow-sm data-card">
                <div class="flex justify-between items-center">
                    <h3 class="text-gray-500 text-sm">Avg. Response Time</h3>
                    <span class="text-indigo-500">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                    </span>
                </div>
                <div class="mt-2">
                    <h2 class="text-3xl font-bold" id="responseTime">0h</h2>
                    <div class="w-full bg-gray-200 rounded-full h-2.5 mt-2">
                        <div class="bg-indigo-600 h-2.5 rounded-full" id="responseTimeBar" style="width: 0%"></div>
                    </div>
                    <p class="text-sm text-gray-500 mt-1">
                        <span id="targetResponseTime">Target: 4h</span>
                    </p>
                </div>
            </div>
        </div>
        
        <!-- Data Visualization Section -->
        <div class="mb-6 grid grid-cols-1 md:grid-cols-2 gap-4">
            <div class="bg-white p-4 rounded-lg border border-gray-200 shadow-sm">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-lg font-semibold">Fault Trends</h2>
                    <div class="flex space-x-2">
                        <button class="px-3 py-1 text-sm rounded-md border border-gray-300 hover:bg-gray-50 bg-blue-100 text-blue-700 border-blue-300" onclick="updateChart('weekly')">Weekly</button>
                        <button class="px-3 py-1 text-sm rounded-md border border-gray-300 hover:bg-gray-50" onclick="updateChart('monthly')">Monthly</button>
                        <button class="px-3 py-1 text-sm rounded-md border border-gray-300 hover:bg-gray-50" onclick="updateChart('yearly')">Yearly</button>
                    </div>
                </div>
                <div class="chart-container">
                    <canvas id="faultTrendsChart"></canvas>
                </div>
            </div>
            
            <div class="bg-white p-4 rounded-lg border border-gray-200 shadow-sm">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-lg font-semibold">Fault Type Distribution</h2>
                    <div class="flex space-x-2">
                        <button class="px-3 py-1 text-sm rounded-md border border-gray-300 hover:bg-gray-50 bg-blue-100 text-blue-700 border-blue-300" onclick="updateFaultTypeChart('all')">All</button>
                        <button class="px-3 py-1 text-sm rounded-md border border-gray-300 hover:bg-gray-50" onclick="updateFaultTypeChart('region')">By Region</button>
                    </div>
                </div>
                <div class="chart-container">
                    <canvas id="faultTypeChart"></canvas>
                </div>
            </div>
        </div>
        
        <!-- Fault Distribution Section -->
        <div class="mb-6 grid grid-cols-1 md:grid-cols-3 gap-4">
            <div class="bg-white p-4 rounded-lg border border-gray-200 shadow-sm col-span-1">
                <h2 class="text-lg font-semibold mb-4">Fault Status</h2>
                <div class="chart-container" style="height: 250px;">
                    <canvas id="faultStatusChart"></canvas>
                </div>
            </div>
            
            <div class="bg-white p-4 rounded-lg border border-gray-200 shadow-sm col-span-2">
                <h2 class="text-lg font-semibold mb-4">Hourly Fault Distribution</h2>
                <div class="chart-container">
                    <canvas id="hourlyFaultChart"></canvas>
                </div>
            </div>
        </div>
        
        <!-- Fault Management Section -->
        <div class="mb-6">
            <div class="flex justify-between items-center mb-3">
                <h2 class="text-lg font-semibold">Recent Faults</h2>
                <div class="flex space-x-2">
                    <div class="relative">
                        <input id="faultSearch" type="text" placeholder="Search faults..." class="pl-8 pr-3 py-1 border rounded-md" onkeyup="searchFaults()">
                        <svg class="w-4 h-4 text-gray-400 absolute left-2 top-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                        </svg>
                    </div>
                    <button onclick="showAddFaultModal()" class="px-3 py-1 bg-blue-600 text-white rounded-md hover:bg-blue-700 text-sm flex items-center">
                        <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                        </svg>
                        Add Fault
                    </button>
                </div>
            </div>
            
            <div class="overflow-x-auto bg-white rounded-lg border border-gray-200 shadow-sm">
                <table class="min-w-full divide-y divide-gray-200">
                    <thead class="bg-gray-50">
                        <tr>
                            <th class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ID</th>
                            <th class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Customer</th>
                            <th class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Fault Type</th>
                            <th class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Timestamp</th>
                            <th class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                            <th class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                        </tr>
                    </thead>
                    <tbody class="bg-white divide-y divide-gray-200" id="faultTableBody">
                        <!-- Fault data will appear here -->
                        <tr>
                            <td colspan="6" class="px-3 py-4 text-center text-gray-500">Loading faults...</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <div class="mt-3 flex justify-between">
                <button onclick="refreshFaults()" class="px-3 py-1 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 text-sm flex items-center">
                    <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                    </svg>
                    Refresh
                </button>
                <div class="text-sm text-gray-500">
                    Showing <span id="faultCount">0</span> faults
                </div>
            </div>
        </div>
        
        <!-- Data Insights Section -->
        <div class="mb-6">
            <h2 class="text-lg font-semibold mb-3">Fault Insights</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4" id="insightsContainer">
                <!-- Insights will be generated here -->
            </div>
            <div class="mt-4 text-center">
                <button onclick="generateInsights()" class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 text-sm flex items-center mx-auto">
                    <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                    </svg>
                    Generate New Insights
                </button>
            </div>
        </div>
    </div>
    
    <!-- Modal for Add Fault -->
    <div id="addFaultModal" class="fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center hidden z-50">
        <div class="bg-white rounded-lg p-6 max-w-md w-full">
            <h3 class="text-lg font-semibold mb-4">Add New Fault</h3>
            <form id="addFaultForm" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Customer Name</label>
                    <input type="text" id="customerName" class="w-full p-2 border rounded-lg">
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Email</label>
                    <input type="email" id="customerEmail" class="w-full p-2 border rounded-lg">
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Address</label>
                    <input type="text" id="customerAddress" class="w-full p-2 border rounded-lg">
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Fault Type</label>
                    <select id="faultType" class="w-full p-2 border rounded-lg">
                        <option value="Power Outage">Power Outage</option>
                        <option value="Internet Disruption">Internet Disruption</option>
                        <option value="Cable Damage">Cable Damage</option>
                    </select>
                </div>
                
                <div class="flex justify-end space-x-2">
                    <button type="button" onclick="hideAddFaultModal()" class="px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300">Cancel</button>
                    <button type="button" onclick="addFault()" class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700">Add Fault</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- JavaScript Code -->
    <script>
        // Utility Functions
        function showNotification(message, type = 'info') {
            const container = document.getElementById('notificationContainer');
            const notification = document.createElement('div');
            
            // Set notification style based on type
            let bgColor, borderColor, textColor;
            switch (type) {
                case 'success':
                    bgColor = 'bg-green-100';
                    borderColor = 'border-green-400';
                    textColor = 'text-green-800';
                    break;
                case 'error':
                    bgColor = 'bg-red-100';
                    borderColor = 'border-red-400';
                    textColor = 'text-red-800';
                    break;
                default:
                    bgColor = 'bg-blue-100';
                    borderColor = 'border-blue-400';
                    textColor = 'text-blue-800';
            }
            
            notification.className = `${bgColor} ${borderColor} ${textColor} border px-4 py-3 rounded mb-2`;
            notification.innerHTML = message;
            
            container.appendChild(notification);
            
            // Remove notification after 3 seconds
            setTimeout(() => {
                notification.style.opacity = '0';
                notification.style.transition = 'opacity 0.5s ease';
                setTimeout(() => {
                    container.removeChild(notification);
                }, 500);
            }, 3000);
        }
        
        function showAddFaultModal() {
            document.getElementById('addFaultModal').classList.remove('hidden');
        }
        
        function hideAddFaultModal() {
            document.getElementById('addFaultModal').classList.add('hidden');
            document.getElementById('addFaultForm').reset();
        }
        
        function getRandomInt(min, max) {
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }
        
        function createGradient(ctx, colorStart, colorEnd) {
            const gradient = ctx.createLinearGradient(0, 0, 0, 300);
            gradient.addColorStop(0, colorStart);
            gradient.addColorStop(1, colorEnd);
            return gradient;
        }

        // Load the provided fault data
        const initialFaultData = [
            { id: 1, name: "Tan Wei Ling", email: "tan.weiling@example.com", address: "123 Orchard Road, Singapore 238888", faultId: 101, faultType: "Power Outage", timestamp: "01/03/2025 10:00:00", status: "Pending" },
            { id: 2, name: "Lim Kai Sheng", email: "lim.kaisheng@example.com", address: "456 Bukit Timah Road, Singapore 259999", faultId: 102, faultType: "Internet Disruption", timestamp: "01/03/2025 11:00:00", status: "Pending" },
            { id: 3, name: "Ong Mei Hui", email: "ong.meihui@example.com", address: "789 Clementi Avenue 3, Singapore 120789", faultId: 103, faultType: "Cable Damage", timestamp: "01/03/2025 12:00:00", status: "Pending" },
            { id: 4, name: "Chua Jia Hao", email: "chua.jiahao@example.com", address: "101 Tampines Street 11, Singapore 520101", faultId: 104, faultType: "Power Outage", timestamp: "01/03/2025 13:00:00", status: "Pending" },
            { id: 5, name: "Lee Xin Yi", email: "lee.xinyi@example.com", address: "202 Bedok North Road, Singapore 460202", faultId: 105, faultType: "Power Outage", timestamp: "01/03/2025 14:00:00", status: "Pending" },
            { id: 6, name: "Goh Jun Wei", email: "goh.junwei@example.com", address: "303 Yishun Avenue 5, Singapore 760303", faultId: 106, faultType: "Internet Disruption", timestamp: "01/03/2025 15:00:00", status: "Pending" },
            { id: 7, name: "Ng Wei Jie", email: "ng.weijie@example.com", address: "505 Hougang Avenue 8, Singapore 530505", faultId: 107, faultType: "Cable Damage", timestamp: "01/03/2025 16:00:00", status: "Pending" },
            { id: 8, name: "Tan Hui Min", email: "tan.huimin@example.com", address: "404 Ang Mo Kio Avenue 10, Singapore 560404", faultId: 108, faultType: "Cable Damage", timestamp: "01/03/2025 17:00:00", status: "Pending" },
            { id: 9, name: "Lim Shi Ying", email: "lim.shiying@example.com", address: "606 Punggol Walk, Singapore 828606", faultId: 109, faultType: "Internet Disruption", timestamp: "01/03/2025 18:00:00", status: "Pending" },
            { id: 10, name: "Koh Jia En", email: "koh.jiaen@example.com", address: "707 Sengkang East Way, Singapore 540707", faultId: 110, faultType: "Cable Damage", timestamp: "01/03/2025 19:00:00", status: "Pending" }
        ];
        
        // Generate additional fault data
        function generateAdditionalFaultData(count = 15) {
            const names = ["Zhang Wei", "Wang Li", "Liu Xin", "Chen Ming", "Yang Jie", "Zhao Hong", "Wu Fang", "Zhou Yu", "Sun Ling", "Li Yan", "Huang Jun", "Xu Feng", "He Mei", "Zhu Hua", "Gao Ping"];
            const addresses = [
                "808 Jurong West Street 81, Singapore 640808",
                "909 Woodlands Drive 50, Singapore 730909",
                "111 Bishan Street 12, Singapore 570111",
                "222 Serangoon Avenue 4, Singapore 550222",
                "333 Pasir Ris Drive 6, Singapore 510333",
                "444 Choa Chu Kang Avenue 3, Singapore 680444",
                "555 Bukit Batok Street 52, Singapore 650555",
                "666 Toa Payoh Lorong 5, Singapore 310666",
                "777 Geylang East Avenue 1, Singapore 389777",
                "888 Marine Parade Central, Singapore 440888",
                "999 Simei Street 3, Singapore 520999",
                "123 Bukit Merah View, Singapore 150123",
                "456 Kallang Bahru, Singapore 330456",
                "789 Telok Blangah Heights, Singapore 100789",
                "101 Jalan Besar, Singapore 208801"
            ];
            const faultTypes = ["Power Outage", "Internet Disruption", "Cable Damage"];
            const statuses = ["Pending", "In Progress", "Resolved", "Escalated"];
            
            const additionalFaults = [];
            
            for (let i = 0; i < count; i++) {
                const name = names[i % names.length];
                const email = name.toLowerCase().replace(' ', '.') + '@example.com';
                const address = addresses[i % addresses.length];
                const faultType = faultTypes[Math.floor(Math.random() * faultTypes.length)];
                const status = statuses[Math.floor(Math.random() * statuses.length)];
                
                // Generate random date within the last 7 days
                const days = Math.floor(Math.random() * 7);
                const hours = Math.floor(Math.random() * 24);
                const minutes = Math.floor(Math.random() * 60);
                
                const date = new Date(2025, 2, 1 + days);
                date.setHours(hours, minutes, 0);
                
                const timestamp = date.toLocaleString('en-US', {
                    day: '2-digit',
                    month: '2-digit',
                    year: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit',
                    second: '2-digit',
                    hour12: false
                }).replace(',', '');
                
                additionalFaults.push({
                    id: 11 + i,
                    name: name,
                    email: email,
                    address: address,
                    faultId: 111 + i,
                    faultType: faultType,
                    timestamp: timestamp,
                    status: status
                });
            }
            
            return additionalFaults;
        }
        
        // Chart Variables
        let faultTrendsChart;
        let faultTypeChart;
        let faultStatusChart;
        let hourlyFaultChart;
        
        // Data Variables
        let faultData = [...initialFaultData];
        let timeSeriesData = {
            weekly: [],
            monthly: [],
            yearly: []
        };
        
        // Initialize Dashboard
        function initializeDashboard() {
            // Add additional fault data
            const additionalFaults = generateAdditionalFaultData(15);
            faultData = [...faultData, ...additionalFaults];
            
            // Generate time series data
            generateTimeSeriesData();
            
            // Update dashboard metrics
            updateDashboardMetrics();
            
            // Populate tables
            populateFaultTable();
            
            // Initialize charts
            initializeCharts();
            
            // Generate initial insights
            generateInsights();
            
            // Show success notification
            showNotification('Dashboard data loaded successfully!', 'success');
        }
        
        function generateTimeSeriesData() {
            // Generate weekly data (last 7 days)
            for (let i = 6; i >= 0; i--) {
                const date = new Date(2025, 2, 1 + i);
                
                timeSeriesData.weekly.push({
                    date: date.toISOString().split('T')[0],
                    powerOutage: getRandomInt(3, 8),
                    internetDisruption: getRandomInt(2, 7),
                    cableDamage: getRandomInt(1, 6)
                });
            }
            
            // Generate monthly data (last 30 days)
            for (let i = 29; i >= 0; i--) {
                const date = new Date(2025, 1, 1 + i);
                
                timeSeriesData.monthly.push({
                    date: date.toISOString().split('T')[0],
                    powerOutage: getRandomInt(10, 25),
                    internetDisruption: getRandomInt(8, 20),
                    cableDamage: getRandomInt(5, 15)
                });
            }
            
            // Generate yearly data (last 12 months)
            for (let i = 11; i >= 0; i--) {
                const date = new Date(2024, i, 1);
                
                timeSeriesData.yearly.push({
                    date: date.toISOString().split('T')[0],
                    powerOutage: getRandomInt(50, 100),
                    internetDisruption: getRandomInt(40, 90),
                    cableDamage: getRandomInt(30, 80)
                });
            }
        }
        
        function updateDashboardMetrics() {
            // Calculate total faults
            document.getElementById('totalFaults').textContent = faultData.length;
            document.getElementById('faultGrowth').textContent = '12%';
            document.getElementById('faultCount').textContent = faultData.length;
            
            // Calculate power outages
            const powerOutages = faultData.filter(fault => fault.faultType === 'Power Outage').length;
            const powerOutagePercentage = Math.round((powerOutages / faultData.length) * 100);
            document.getElementById('powerOutages').textContent = powerOutages;
            document.getElementById('outagePercentage').textContent = `${powerOutagePercentage}%`;
            
            // Calculate resolution rate
            const resolvedFaults = faultData.filter(fault => fault.status === 'Resolved').length;
            const resolutionRate = Math.round((resolvedFaults / faultData.length) * 100);
            document.getElementById('resolutionRate').textContent = `${resolutionRate}%`;
            document.getElementById('resolutionGrowth').textContent = '5%';
            
            // Calculate average response time (fictional)
            const responseTime = 3;
            const responseTimePercentage = Math.round((responseTime / 4) * 100);
            document.getElementById('responseTime').textContent = `${responseTime}h`;
            document.getElementById('responseTimeBar').style.width = `${responseTimePercentage}%`;
        }
        
        function initializeCharts() {
            // Initialize Fault Trends Chart
            const faultTrendsCtx = document.getElementById('faultTrendsChart').getContext('2d');
            
            // Create gradients for each fault type
            const powerOutageGradient = createGradient(faultTrendsCtx, 'rgba(239, 68, 68, 0.8)', 'rgba(239, 68, 68, 0.1)');
            const internetDisruptionGradient = createGradient(faultTrendsCtx, 'rgba(59, 130, 246, 0.8)', 'rgba(59, 130, 246, 0.1)');
            const cableDamageGradient = createGradient(faultTrendsCtx, 'rgba(16, 185, 129, 0.8)', 'rgba(16, 185, 129, 0.1)');
            
            faultTrendsChart = new Chart(faultTrendsCtx, {
                type: 'line',
                data: {
                    labels: timeSeriesData.weekly.map(d => {
                        const date = new Date(d.date);
                        return date.toLocaleDateString('en-US', { weekday: 'short' });
                    }),
                    datasets: [
                        {
                            label: 'Power Outage',
                            data: timeSeriesData.weekly.map(d => d.powerOutage),
                            borderColor: 'rgb(239, 68, 68)',
                            backgroundColor: powerOutageGradient,
                            fill: true,
                            tension: 0.4
                        },
                        {
                            label: 'Internet Disruption',
                            data: timeSeriesData.weekly.map(d => d.internetDisruption),
                            borderColor: 'rgb(59, 130, 246)',
                            backgroundColor: internetDisruptionGradient,
                            fill: true,
                            tension: 0.4
                        },
                        {
                            label: 'Cable Damage',
                            data: timeSeriesData.weekly.map(d => d.cableDamage),
                            borderColor: 'rgb(16, 185, 129)',
                            backgroundColor: cableDamageGradient,
                            fill: true,
                            tension: 0.4
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                        },
                        title: {
                            display: false
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false
                        }
                    },
                    hover: {
                        mode: 'nearest',
                        intersect: true
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Number of Faults'
                            }
                        }
                    }
                }
            });
            
            // Initialize Fault Type Chart
            const faultTypeCtx = document.getElementById('faultTypeChart').getContext('2d');
            
            // Count faults by type
            const faultTypeCounts = {};
            faultData.forEach(fault => {
                faultTypeCounts[fault.faultType] = (faultTypeCounts[fault.faultType] || 0) + 1;
            });
            
            // Create gradient colors for the pie chart
            const pieColors = [
                createGradient(faultTypeCtx, 'rgba(239, 68, 68, 0.8)', 'rgba(239, 68, 68, 0.5)'),
                createGradient(faultTypeCtx, 'rgba(59, 130, 246, 0.8)', 'rgba(59, 130, 246, 0.5)'),
                createGradient(faultTypeCtx, 'rgba(16, 185, 129, 0.8)', 'rgba(16, 185, 129, 0.5)')
            ];
            
            faultTypeChart = new Chart(faultTypeCtx, {
                type: 'doughnut',
                data: {
                    labels: Object.keys(faultTypeCounts),
                    datasets: [{
                        data: Object.values(faultTypeCounts),
                        backgroundColor: pieColors,
                        borderColor: 'white',
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'right',
                            labels: {
                                boxWidth: 12,
                                font: {
                                    size: 11
                                }
                            }
                        }
                    },
                    cutout: '60%'
                }
            });
            
            // Initialize Fault Status Chart
            const faultStatusCtx = document.getElementById('faultStatusChart').getContext('2d');
            
            // Count faults by status
            const faultStatusCounts = {};
            faultData.forEach(fault => {
                faultStatusCounts[fault.status] = (faultStatusCounts[fault.status] || 0) + 1;
            });
            
            // Create gradient colors for the status chart
            const statusColors = [
                createGradient(faultStatusCtx, 'rgba(245, 158, 11, 0.8)', 'rgba(245, 158, 11, 0.5)'), // Pending
                createGradient(faultStatusCtx, 'rgba(79, 70, 229, 0.8)', 'rgba(79, 70, 229, 0.5)'),   // In Progress
                createGradient(faultStatusCtx, 'rgba(16, 185, 129, 0.8)', 'rgba(16, 185, 129, 0.5)'), // Resolved
                createGradient(faultStatusCtx, 'rgba(239, 68, 68, 0.8)', 'rgba(239, 68, 68, 0.5)')    // Escalated
            ];
            
            faultStatusChart = new Chart(faultStatusCtx, {
                type: 'pie',
                data: {
                    labels: Object.keys(faultStatusCounts),
                    datasets: [{
                        data: Object.values(faultStatusCounts),
                        backgroundColor: statusColors,
                        borderColor: 'white',
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                boxWidth: 12,
                                font: {
                                    size: 11
                                }
                            }
                        }
                    }
                }
            });
            
            // Initialize Hourly Fault Chart
            const hourlyFaultCtx = document.getElementById('hourlyFaultChart').getContext('2d');
            
            // Count faults by hour
            const hourlyData = Array(24).fill(0);
            faultData.forEach(fault => {
                const hour = new Date(fault.timestamp.replace(/(\d+)\/(\d+)\/(\d+)/, '$3-$1-$2')).getHours();
                hourlyData[hour]++;
            });
            
            // Create gradient for bar chart
            const barGradient = createGradient(hourlyFaultCtx, 'rgba(99, 102, 241, 0.8)', 'rgba(99, 102, 241, 0.2)');
            
            hourlyFaultChart = new Chart(hourlyFaultCtx, {
                type: 'bar',
                data: {
                    labels: Array.from({length: 24}, (_, i) => i),
                    datasets: [{
                        label: 'Faults',
                        data: hourlyData,
                        backgroundColor: barGradient,
                        borderColor: 'rgba(99, 102, 241, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        title: {
                            display: false
                        }
                    },
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'Hour of Day (24h)'
                            }
                        },
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Number of Faults'
                            }
                        }
                    }
                }
            });
        }
        
        function updateChart(timeframe) {
            const data = timeSeriesData[timeframe];
            
            // Update labels based on timeframe
            let labels;
            if (timeframe === 'weekly') {
                labels = data.map(d => {
                    const date = new Date(d.date);
                    return date.toLocaleDateString('en-US', { weekday: 'short' });
                });
            } else if (timeframe === 'monthly') {
                labels = data.map(d => {
                    const date = new Date(d.date);
                    return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
                });
            } else {
                labels = data.map(d => {
                    const date = new Date(d.date);
                    return date.toLocaleDateString('en-US', { month: 'short' });
                });
            }
            
            faultTrendsChart.data.labels = labels;
            faultTrendsChart.data.datasets[0].data = data.map(d => d.powerOutage);
            faultTrendsChart.data.datasets[1].data = data.map(d => d.internetDisruption);
            faultTrendsChart.data.datasets[2].data = data.map(d => d.cableDamage);
            
            faultTrendsChart.update();
            
            // Update buttons to show active state
            const buttons = document.querySelectorAll('button[onclick^="updateChart"]');
            buttons.forEach(button => {
                if (button.getAttribute('onclick').includes(timeframe)) {
                    button.classList.add('bg-blue-100', 'text-blue-700', 'border-blue-300');
                } else {
                    button.classList.remove('bg-blue-100', 'text-blue-700', 'border-blue-300');
                }
            });
        }
        
        function updateFaultTypeChart(view) {
            if (view === 'all') {
                // Count faults by type
                const faultTypeCounts = {};
                faultData.forEach(fault => {
                    faultTypeCounts[fault.faultType] = (faultTypeCounts[fault.faultType] || 0) + 1;
                });
                
                faultTypeChart.data.labels = Object.keys(faultTypeCounts);
                faultTypeChart.data.datasets[0].data = Object.values(faultTypeCounts);
                faultTypeChart.config.type = 'doughnut';
                
                // Reset options for doughnut chart
                faultTypeChart.options = {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'right',
                            labels: {
                                boxWidth: 12,
                                font: {
                                    size: 11
                                }
                            }
                        }
                    },
                    cutout: '60%'
                };
            } else if (view === 'region') {
                // Group faults by region and type
                const regions = ['North', 'South', 'East', 'West', 'Central'];
                const faultTypes = ['Power Outage', 'Internet Disruption', 'Cable Damage'];
                
                // Generate random data for each region and fault type
                const datasets = faultTypes.map((type, index) => {
                    const colors = [
                        'rgba(239, 68, 68, 0.8)',  // red for Power Outage
                        'rgba(59, 130, 246, 0.8)', // blue for Internet Disruption
                        'rgba(16, 185, 129, 0.8)'  // green for Cable Damage
                    ];
                    
                    return {
                        label: type,
                        data: regions.map(() => getRandomInt(5, 15)),
                        backgroundColor: colors[index],
                        borderColor: colors[index],
                        borderWidth: 1
                    };
                });
                
                faultTypeChart.data.labels = regions;
                faultTypeChart.data.datasets = datasets;
                faultTypeChart.config.type = 'bar';
                
                // Set options for bar chart
                faultTypeChart.options = {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                        }
                    },
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'Region'
                            }
                        },
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Number of Faults'
                            },
                            stacked: false
                        }
                    }
                };
            }
            
            faultTypeChart.update();
            
            // Update buttons to show active state
            const buttons = document.querySelectorAll('button[onclick^="updateFaultTypeChart"]');
            buttons.forEach(button => {
                if (button.getAttribute('onclick').includes(view)) {
                    button.classList.add('bg-blue-100', 'text-blue-700', 'border-blue-300');
                } else {
                    button.classList.remove('bg-blue-100', 'text-blue-700', 'border-blue-300');
                }
            });
        }
        
        function populateFaultTable() {
            const tableBody = document.getElementById('faultTableBody');
            tableBody.innerHTML = '';
            
            // Sort faults by timestamp (newest first)
            const sortedFaults = [...faultData].sort((a, b) => {
                const dateA = new Date(a.timestamp.replace(/(\d+)\/(\d+)\/(\d+)/, '$3-$1-$2'));
                const dateB = new Date(b.timestamp.replace(/(\d+)\/(\d+)\/(\d+)/, '$3-$1-$2'));
                return dateB - dateA;
            });
            
            sortedFaults.forEach(fault => {
                const row = document.createElement('tr');
                
                // Create status badge with appropriate color
                let statusClass;
                switch (fault.status) {
                    case 'Resolved':
                        statusClass = 'bg-green-100 text-green-800 border-green-200';
                        break;
                    case 'In Progress':
                        statusClass = 'bg-blue-100 text-blue-800 border-blue-200';
                        break;
                    case 'Escalated':
                        statusClass = 'bg-red-100 text-red-800 border-red-200';
                        break;
                    default:
                        statusClass = 'bg-yellow-100 text-yellow-800 border-yellow-200';
                }
                
                // Format the timestamp
                const formattedDate = fault.timestamp;
                
                row.innerHTML = `
                    <td class="px-3 py-3 whitespace-nowrap">
                        <div class="text-sm text-gray-900">${fault.faultId}</div>
                    </td>
                    <td class="px-3 py-3 whitespace-nowrap">
                        <div class="flex items-center">
                            <div class="flex-shrink-0 h-8 w-8 rounded-full bg-indigo-500 flex items-center justify-center text-white font-medium">
                                ${fault.name.charAt(0)}
                            </div>
                            <div class="ml-3">
                                <div class="font-medium text-gray-900">${fault.name}</div>
                                <div class="text-xs text-gray-500">${fault.email}</div>
                            </div>
                        </div>
                    </td>
                    <td class="px-3 py-3 whitespace-nowrap">
                        <div class="text-sm text-gray-900">${fault.faultType}</div>
                    </td>
                    <td class="px-3 py-3 whitespace-nowrap">
                        <div class="text-sm text-gray-500">${formattedDate}</div>
                    </td>
                    <td class="px-3 py-3 whitespace-nowrap">
                        <span class="px-2 py-1 text-xs rounded-full ${statusClass} border">
                            ${fault.status}
                        </span>
                    </td>
                    <td class="px-3 py-3 whitespace-nowrap text-sm text-gray-500">
                        <button class="text-blue-600 hover:text-blue-800 mr-2" onclick="updateFaultStatus(${fault.faultId})">Update</button>
                        <button class="text-red-600 hover:text-red-800" onclick="deleteFault(${fault.faultId})">Delete</button>
                    </td>
                `;
                
                tableBody.appendChild(row);
            });
            
            // Add row hover effect
            const rows = tableBody.querySelectorAll('tr');
            rows.forEach(row => {
                row.addEventListener('mouseenter', () => {
                    row.classList.add('bg-gray-50', 'cursor-pointer');
                });
                row.addEventListener('mouseleave', () => {
                    row.classList.remove('bg-gray-50');
                });
            });
        }
        
        function updateFaultStatus(faultId) {
            const fault = faultData.find(f => f.faultId === faultId);
            if (fault) {
                // Cycle through statuses: Pending -> In Progress -> Resolved -> Pending
                switch (fault.status) {
                    case 'Pending':
                        fault.status = 'In Progress';
                        break;
                    case 'In Progress':
                        fault.status = 'Resolved';
                        break;
                    case 'Resolved':
                        fault.status = 'Pending';
                        break;
                    case 'Escalated':
                        fault.status = 'In Progress';
                        break;
                    default:
                        fault.status = 'Pending';
                }
                
                populateFaultTable();
                updateDashboardMetrics();
                updateFaultStatusChart();
                
                showNotification(`Fault #${faultId} status updated to ${fault.status}`, 'success');
            }
        }
        
        function deleteFault(faultId) {
            const faultIndex = faultData.findIndex(f => f.faultId === faultId);
            if (faultIndex !== -1) {
                faultData.splice(faultIndex, 1);
                populateFaultTable();
                updateDashboardMetrics();
                updateFaultTypeChart('all');
                updateFaultStatusChart();
                
                showNotification(`Fault #${faultId} deleted successfully!`, 'success');
            }
        }
        
        function updateFaultStatusChart() {
            // Count faults by status
            const faultStatusCounts = {};
            faultData.forEach(fault => {
                faultStatusCounts[fault.status] = (faultStatusCounts[fault.status] || 0) + 1;
            });
            
            faultStatusChart.data.labels = Object.keys(faultStatusCounts);
            faultStatusChart.data.datasets[0].data = Object.values(faultStatusCounts);
            
            faultStatusChart.update();
        }
        
        function addFault() {
            const customerName = document.getElementById('customerName').value;
            const customerEmail = document.getElementById('customerEmail').value;
            const customerAddress = document.getElementById('customerAddress').value;
            const faultType = document.getElementById('faultType').value;
            
            if (!customerName || !customerEmail || !customerAddress) {
                showNotification('Please fill in all required fields', 'error');
                return;
            }
            
            // Get the next fault ID
            const maxFaultId = Math.max(...faultData.map(f => f.faultId));
            const nextFaultId = maxFaultId + 1;
            
            // Get the next customer ID
            const maxId = Math.max(...faultData.map(f => f.id));
            const nextId = maxId + 1;
            
            // Create new fault
            const now = new Date();
            const timestamp = now.toLocaleString('en-US', {
                day: '2-digit',
                month: '2-digit',
                year: 'numeric',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit',
                hour12: false
            }).replace(',', '');
            
            const newFault = {
                id: nextId,
                name: customerName,
                email: customerEmail,
                address: customerAddress,
                faultId: nextFaultId,
                faultType: faultType,
                timestamp: timestamp,
                status: 'Pending'
            };
            
            faultData.push(newFault);
            populateFaultTable();
            updateDashboardMetrics();
            updateFaultTypeChart('all');
            updateFaultStatusChart();
            hideAddFaultModal();
            
            showNotification('Fault added successfully!', 'success');
        }
        
        function searchFaults() {
            const searchInput = document.getElementById('faultSearch').value.toLowerCase();
            const tableBody = document.getElementById('faultTableBody');
            const rows = tableBody.querySelectorAll('tr');
            
            rows.forEach(row => {
                const nameCell = row.querySelector('td:nth-child(2) div.font-medium');
                const faultTypeCell = row.querySelector('td:nth-child(3) div.text-sm');
                
                if (nameCell && faultTypeCell) {
                    const name = nameCell.textContent.toLowerCase();
                    const faultType = faultTypeCell.textContent.toLowerCase();
                    const faultId = row.querySelector('td:first-child div').textContent.toLowerCase();
                    
                    if (name.includes(searchInput) || faultType.includes(searchInput) || faultId.includes(searchInput)) {
                        row.style.display = '';
                    } else {
                        row.style.display = 'none';
                    }
                }
            });
            
            // Update count of displayed faults
            const visibleRows = [...rows].filter(row => row.style.display !== 'none').length;
            document.getElementById('faultCount').textContent = visibleRows;
        }
        
        function refreshFaults() {
            const refreshButton = document.querySelector('button[onclick="refreshFaults()"]');
            
            // Show loading state
            refreshButton.innerHTML = `
                <svg class="animate-spin w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                </svg>
                Refreshing...
            `;
            
            // Simulate API call delay
            setTimeout(() => {
                // Generate new fault data
                faultData = [...initialFaultData, ...generateAdditionalFaultData(15)];
                populateFaultTable();
                updateDashboardMetrics();
                updateFaultTypeChart('all');
                updateFaultStatusChart();
                
                refreshButton.innerHTML = `
                    <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                    </svg>
                    Refresh
                `;
                
                // Show success notification
                showNotification('Fault data refreshed successfully!', 'success');
            }, 1000);
        }
        
        function generateInsights() {
            const insightsContainer = document.getElementById('insightsContainer');
            
            // Show loading state
            insightsContainer.innerHTML = `
                <div class="col-span-1 md:col-span-3 flex justify-center items-center p-8">
                    <svg class="animate-spin w-8 h-8 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                    </svg>
                    <span class="ml-3 text-gray-600">Generating insights...</span>
                </div>
            `;
            
            // Generate insights based on data
            setTimeout(() => {
                insightsContainer.innerHTML = '';
                
                // Calculate fault type distribution
                const faultTypeCounts = {};
                faultData.forEach(fault => {
                    faultTypeCounts[fault.faultType] = (faultTypeCounts[fault.faultType] || 0) + 1;
                });
                
                const mostCommonFault = Object.keys(faultTypeCounts).reduce((a, b) => 
                    faultTypeCounts[a] > faultTypeCounts[b] ? a : b
                );
                
                const powerOutages = faultTypeCounts['Power Outage'] || 0;
                const totalFaults = faultData.length;
                const powerOutagePercentage = Math.round((powerOutages / totalFaults) * 100);
                
                // Calculate pending faults
                const pendingFaults = faultData.filter(fault => fault.status === 'Pending').length;
                const pendingPercentage = Math.round((pendingFaults / totalFaults) * 100);
                
                // Create insight cards
                const insights = [
                    {
                        title: 'Fault Distribution',
                        content: `${mostCommonFault} is your most common fault type at ${Math.round((faultTypeCounts[mostCommonFault] / totalFaults) * 100)}% of all reported issues.`,
                        type: 'info',
                        icon: 'chart'
                    },
                    {
                        title: 'Power Outage Analysis',
                        content: `Power outages represent ${powerOutagePercentage}% of all faults. Consider investigating common causes in affected areas.`,
                        type: powerOutagePercentage > 40 ? 'warning' : 'info',
                        icon: 'power'
                    },
                    {
                        title: 'Resolution Status',
                        content: `${pendingPercentage}% of faults are still pending resolution. The average response time is currently 3 hours.`,
                        type: pendingPercentage > 70 ? 'warning' : 'info',
                        icon: 'status'
                    }
                ];
                
                // Add insights that need attention
                if (pendingFaults > 10) {
                    insights.push({
                        title: 'Attention Required',
                        content: `${pendingFaults} faults are currently pending. Consider allocating additional resources to reduce the backlog.`,
                        type: 'warning',
                        icon: 'alert'
                    });
                }
                
                // Create insight cards
                insights.forEach(insight => {
                    const card = document.createElement('div');
                    
                    // Set card style based on insight type
                    let borderColor, bgColor, iconColor, iconSvg;
                    
                    switch (insight.type) {
                        case 'success':
                            borderColor = 'border-green-200';
                            bgColor = 'bg-green-50';
                            iconColor = 'text-green-500';
                            break;
                        case 'warning':
                            borderColor = 'border-yellow-200';
                            bgColor = 'bg-yellow-50';
                            iconColor = 'text-yellow-500';
                            break;
                        default:
                            borderColor = 'border-blue-200';
                            bgColor = 'bg-blue-50';
                            iconColor = 'text-blue-500';
                    }
                    
                    // Set icon based on insight category
                    switch (insight.icon) {
                        case 'chart':
                            iconSvg = '<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path></svg>';
                            break;
                        case 'power':
                            iconSvg = '<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg>';
                            break;
                        case 'status':
                            iconSvg = '<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>';
                            break;
                        case 'alert':
                            iconSvg = '<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg>';
                            break;
                        default:
                            iconSvg = '<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>';
                    }
                    
                    card.className = `p-4 border ${borderColor} ${bgColor} rounded-lg data-card`;
                    card.innerHTML = `
                        <div class="flex items-center mb-2">
                            <div class="flex-shrink-0 ${iconColor}">
                                ${iconSvg}
                            </div>
                            <h4 class="ml-2 font-semibold">${insight.title}</h4>
                        </div>
                        <p class="text-gray-600">${insight.content}</p>
                    `;
                    
                    insightsContainer.appendChild(card);
                    
                    // Add fade-in animation
                    card.style.opacity = '0';
                    setTimeout(() => {
                        card.style.transition = 'opacity 0.5s ease-in-out';
                        card.style.opacity = '1';
                    }, 100 * insightsContainer.children.length);
                });
                
                // Add data visualization insight with mini chart
                const visualInsight = document.createElement('div');
                visualInsight.className = 'p-4 border border-blue-200 bg-blue-50 rounded-lg data-card';
                visualInsight.innerHTML = `
                    <div class="flex items-center mb-2">
                        <div class="flex-shrink-0 text-blue-500">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                            </svg>
                        </div>
                        <h4 class="ml-2 font-semibold">Hourly Fault Trend</h4>
                    </div>
                    <p class="text-gray-600 mb-3">Faults peak between 9AM-11AM and 2PM-4PM. Consider scheduling additional support staff during these hours.</p>
                    <div id="miniChart" style="height: 100px;"></div>
                `;
                
                insightsContainer.appendChild(visualInsight);
                
                // Add fade-in animation
                visualInsight.style.opacity = '0';
                setTimeout(() => {
                    visualInsight.style.transition = 'opacity 0.5s ease-in-out';
                    visualInsight.style.opacity = '1';
                    
                    // Create mini chart
                    setTimeout(() => {
                        const miniChartCanvas = document.createElement('canvas');
                        document.getElementById('miniChart').appendChild(miniChartCanvas);
                        
                        const ctx = miniChartCanvas.getContext('2d');
                        const gradient = createGradient(ctx, 'rgba(59, 130, 246, 0.8)', 'rgba(59, 130, 246, 0.1)');
                        
                        new Chart(miniChartCanvas, {
                            type: 'line',
                            data: {
                                labels: ['6AM', '8AM', '10AM', '12PM', '2PM', '4PM', '6PM', '8PM'],
                                datasets: [{
                                    label: 'Faults',
                                    data: [2, 5, 8, 4, 7, 9, 5, 3],
                                    borderColor: 'rgb(59, 130, 246)',
                                    backgroundColor: gradient,
                                    tension: 0.3,
                                    fill: true
                                }]
                            },
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                plugins: {
                                    legend: {
                                        display: false
                                    }
                                },
                                scales: {
                                    x: {
                                        display: true,
                                        grid: {
                                            display: false
                                        }
                                    },
                                    y: {
                                        display: true,
                                        beginAtZero: true,
                                        grid: {
                                            display: false
                                        }
                                    }
                                }
                            }
                        });
                    }, 300);
                }, 100 * insightsContainer.children.length);
                
                // Show success notification
                showNotification('Insights generated successfully!', 'success');
            }, 1500);
        }
        
        // Initialize dashboard on load
        window.addEventListener('DOMContentLoaded', function() {
            initializeDashboard();
        });
    </script>
</body>
</html>

